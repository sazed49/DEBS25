2024-12-03 23:11:37,442 INFO _main.py 39:: ################################################################
2024-12-03 23:11:37,443 INFO _main.py 41:: #                              batch_size: 16                  #
2024-12-03 23:11:37,444 INFO _main.py 41:: #                         test_batch_size: 16                  #
2024-12-03 23:11:37,444 INFO _main.py 41:: #                                  epochs: 10                  #
2024-12-03 23:11:37,444 INFO _main.py 41:: #                               optimizer: SGD                 #
2024-12-03 23:11:37,444 INFO _main.py 41:: #                                      lr: 0.01                #
2024-12-03 23:11:37,445 INFO _main.py 41:: #                                momentum: 0.9                 #
2024-12-03 23:11:37,445 INFO _main.py 41:: #                            weight_decay: 0.0001              #
2024-12-03 23:11:37,445 INFO _main.py 41:: #                                    seed: 1                   #
2024-12-03 23:11:37,445 INFO _main.py 41:: #                            log_interval: 11                  #
2024-12-03 23:11:37,445 INFO _main.py 41:: #                             num_clients: 40                  #
2024-12-03 23:11:37,445 INFO _main.py 41:: #                           output_folder: experiments         #
2024-12-03 23:11:37,445 INFO _main.py 41:: #                                 dataset: cifar               #
2024-12-03 23:11:37,445 INFO _main.py 41:: #                             loader_type: dirichlet           #
2024-12-03 23:11:37,445 INFO _main.py 41:: #                             loader_path: ./data/loader.pk    #
2024-12-03 23:11:37,446 INFO _main.py 41:: #                                      AR: mudhog              #
2024-12-03 23:11:37,446 INFO _main.py 41:: #                     n_attacker_backdoor: 0                   #
2024-12-03 23:11:37,446 INFO _main.py 41:: #                        backdoor_trigger: [0, 0, 1, 1]        #
2024-12-03 23:11:37,446 INFO _main.py 41:: #                   n_attacker_omniscient: 0                   #
2024-12-03 23:11:37,446 INFO _main.py 41:: #                        omniscient_scale: 1                   #
2024-12-03 23:11:37,446 INFO _main.py 41:: #                                 attacks: None                #
2024-12-03 23:11:37,446 INFO _main.py 41:: #                      save_model_weights: False               #
2024-12-03 23:11:37,446 INFO _main.py 41:: #                         experiment_name: sExp4Ba_40ep_cifar_mudhog_40C_5#
2024-12-03 23:11:37,446 INFO _main.py 41:: #                          path_to_aggNet: None                #
2024-12-03 23:11:37,446 INFO _main.py 41:: #                                  device: cuda                #
2024-12-03 23:11:37,446 INFO _main.py 41:: #                            inner_epochs: 4                   #
2024-12-03 23:11:37,447 INFO _main.py 41:: #                                 verbose: True                #
2024-12-03 23:11:37,447 INFO _main.py 41:: #                         list_unreliable: [2, 18, 20]         #
2024-12-03 23:11:37,447 INFO _main.py 41:: #                     unreliable_fraction: 0.5                 #
2024-12-03 23:11:37,447 INFO _main.py 41:: #                    unreliable_fracTrain: 0.3                 #
2024-12-03 23:11:37,447 INFO _main.py 41:: #                         mean_unreliable: 0.0                 #
2024-12-03 23:11:37,447 INFO _main.py 41:: #                             blur_method: add_noise           #
2024-12-03 23:11:37,447 INFO _main.py 41:: #                      max_std_unreliable: 30.0                #
2024-12-03 23:11:37,447 INFO _main.py 41:: #                     list_uatk_add_noise: [24, 25, 26]        #
2024-12-03 23:11:37,447 INFO _main.py 41:: #                          mean_add_noise: 0.0                 #
2024-12-03 23:11:37,447 INFO _main.py 41:: #                           std_add_noise: 0.01                #
2024-12-03 23:11:37,447 INFO _main.py 41:: #                     list_uatk_flip_sign: [0, 10, 11]         #
2024-12-03 23:11:37,448 INFO _main.py 42:: ################################################################
2024-12-03 23:11:37,448 INFO _main.py 43:: Namespace(batch_size=16, test_batch_size=16, epochs=10, optimizer='SGD', lr=0.01, momentum=0.9, weight_decay=0.0001, seed=1, log_interval=11, num_clients=40, output_folder='experiments', dataset='cifar', loader_type='dirichlet', loader_path='./data/loader.pk', AR='mudhog', n_attacker_backdoor=0, backdoor_trigger=[0, 0, 1, 1], n_attacker_omniscient=0, omniscient_scale=1, attacks=None, save_model_weights=False, experiment_name='sExp4Ba_40ep_cifar_mudhog_40C_5', path_to_aggNet=None, device='cuda', inner_epochs=4, verbose=True, list_unreliable=[2, 18, 20], unreliable_fraction=0.5, unreliable_fracTrain=0.3, mean_unreliable=0.0, blur_method='add_noise', max_std_unreliable=30.0, list_uatk_add_noise=[24, 25, 26], mean_add_noise=0.0, std_add_noise=0.01, list_uatk_flip_sign=[0, 10, 11])
2024-12-03 23:11:37,448 INFO _main.py 44:: #####################
2024-12-03 23:11:37,448 INFO _main.py 45:: #####################
2024-12-03 23:11:37,448 INFO _main.py 46:: #####################
2024-12-03 23:11:37,448 INFO _main.py 47:: Aggregation Rule:	mudhog
2024-12-03 23:11:37,448 INFO _main.py 48:: Data distribution:	dirichlet
2024-12-03 23:11:37,448 INFO _main.py 49:: Attacks:	None 
2024-12-03 23:11:37,448 INFO _main.py 50:: #####################
2024-12-03 23:11:37,448 INFO _main.py 51:: #####################
2024-12-03 23:11:37,449 INFO _main.py 52:: #####################
2024-12-03 23:11:49,395 INFO server.py 366:: SET DBSCAN eps=18, min_samples=12
2024-12-03 23:11:49,428 INFO _main.py 135:: [1-normal, 0-malicious] label =tensor([0., 1., 1., 1., 1., 1., 1., 1., 1., 1., 0., 0., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 0., 0., 0., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1.])
2024-12-03 23:11:49,704 INFO malicious_clients.py 123:: init ATTACK OMNISCIENT Client 0
2024-12-03 23:11:50,191 INFO malicious_clients.py 18:: init UNRELIABLE Client 2
2024-12-03 23:11:52,398 INFO malicious_clients.py 123:: init ATTACK OMNISCIENT Client 10
2024-12-03 23:11:52,667 INFO malicious_clients.py 123:: init ATTACK OMNISCIENT Client 11
2024-12-03 23:11:54,527 INFO malicious_clients.py 18:: init UNRELIABLE Client 18
2024-12-03 23:11:55,065 INFO malicious_clients.py 18:: init UNRELIABLE Client 20
2024-12-03 23:11:56,197 INFO malicious_clients.py 73:: init ATTACK ADD NOISE TO GRAD Client 24
2024-12-03 23:11:56,464 INFO malicious_clients.py 73:: init ATTACK ADD NOISE TO GRAD Client 25
2024-12-03 23:11:56,743 INFO malicious_clients.py 73:: init ATTACK ADD NOISE TO GRAD Client 26
2024-12-03 23:12:00,490 INFO server.py 211:: [Server] Start testing
2024-12-03 23:12:07,098 INFO server.py 235:: [Server] Test set: Average loss: 2.3743, Accuracy: 907/10000 (9.07%)

2024-12-03 23:12:07,101 INFO server.py 238:: [Sever] Confusion matrix:
 tensor([[229., 420.,   6.,  74.,   8.,   0.,  33.,   1., 166.,  63.],
        [191., 240.,  34., 128.,  24.,   0.,  65.,   0., 125., 193.],
        [271., 348.,  31.,  41.,  11.,   0.,  29.,  10., 148., 111.],
        [173., 335.,  51.,  75.,  22.,   0.,  40.,   3.,  74., 227.],
        [211., 287.,  11.,  43.,   4.,   0.,  28.,  18., 284., 114.],
        [262., 227., 124.,  58.,  29.,   0.,  32.,   4.,  78., 186.],
        [135., 321.,  21.,  28.,   1.,   0.,  48.,   6., 289., 151.],
        [222., 250.,  50., 116.,  26.,   0.,  24.,  10., 157., 145.],
        [317., 366.,   4., 102.,   9.,   0.,  24.,   1., 105.,  72.],
        [269., 286.,  11.,  92.,  17.,   0.,  28.,   0., 132., 165.]])
2024-12-03 23:12:07,503 INFO server.py 254:: [Server] Precision=[0.10043859 0.07792208 0.09037901 0.0990753  0.02649007        nan
 0.13675214 0.18867925 0.06739409 0.11562719],
 Recall=[0.229 0.24  0.031 0.075 0.004 0.    0.048 0.01  0.105 0.165],
 F1-score=[0.13963415 0.11764707 0.0461653  0.08537279 0.00695048        nan
 0.07105848 0.01899335 0.08209538 0.13597034],
 my_accuracy=9.070000052452087[%]
2024-12-03 23:12:07,504 INFO _main.py 209:: ########EPOCH 0 ########
2024-12-03 23:12:07,505 INFO _main.py 210:: ###Model distribution###
2024-12-03 23:13:15,423 INFO server.py 1080:: clients' sizes=[15, 12, 5, 7, 6, 13, 13, 4, 4, 10, 13, 8, 5, 9, 12, 14, 6, 12, 11, 9, 6, 12, 17, 7, 9, 9, 8, 12, 9, 8, 6, 5, 9, 12, 9, 4, 7, 12, 14, 9], total=372
2024-12-03 23:13:18,333 INFO server.py 327:: [Server] The aggregation takes 5.229071 seconds.

2024-12-03 23:13:18,386 INFO server.py 211:: [Server] Start testing
2024-12-03 23:13:23,756 INFO server.py 235:: [Server] Test set: Average loss: 2.1361, Accuracy: 2379/10000 (23.79%)

2024-12-03 23:13:23,758 INFO server.py 238:: [Sever] Confusion matrix:
 tensor([[483.,   0.,  34.,  25., 205., 101.,  81.,   0.,  71.,   0.],
        [ 64.,   3.,   6.,  41., 323., 388., 133.,   1.,  39.,   2.],
        [113.,   0.,  65.,  33., 423., 269.,  95.,   0.,   2.,   0.],
        [ 15.,   0.,  12.,  32., 300., 508., 126.,   3.,   4.,   0.],
        [ 56.,   0.,  19.,  20., 686., 114.,  98.,   1.,   6.,   0.],
        [  7.,   0.,  10.,  16., 227., 658.,  81.,   0.,   1.,   0.],
        [ 31.,   0.,  37.,  21., 477., 198., 235.,   0.,   1.,   0.],
        [ 14.,   0.,   5.,  21., 556., 334.,  56.,  10.,   4.,   0.],
        [374.,   0.,  15.,  27., 168., 121.,  93.,   0., 201.,   1.],
        [ 52.,   4.,   4.,  26., 342., 431.,  81.,   0.,  54.,   6.]])
2024-12-03 23:13:23,760 INFO server.py 254:: [Server] Precision=[0.3995037  0.42857143 0.31400967 0.1221374  0.1850553  0.21076234
 0.21779425 0.6666667  0.5248042  0.6666667 ],
 Recall=[0.483 0.003 0.065 0.032 0.686 0.658 0.235 0.01  0.201 0.006],
 F1-score=[0.43730193 0.00595829 0.10770505 0.05071316 0.29148078 0.3192625
 0.22607023 0.01970443 0.29067245 0.01189296],
 my_accuracy=23.79000037908554[%]
2024-12-03 23:13:23,760 INFO _main.py 209:: ########EPOCH 1 ########
2024-12-03 23:13:23,760 INFO _main.py 210:: ###Model distribution###
2024-12-03 23:14:31,734 INFO server.py 1080:: clients' sizes=[15, 12, 5, 7, 6, 13, 13, 4, 4, 10, 13, 8, 5, 9, 12, 14, 6, 12, 11, 9, 6, 12, 17, 7, 9, 9, 8, 12, 9, 8, 6, 5, 9, 12, 9, 4, 7, 12, 14, 9], total=372
2024-12-03 23:14:34,637 INFO server.py 327:: [Server] The aggregation takes 5.096876 seconds.

2024-12-03 23:14:34,690 INFO server.py 211:: [Server] Start testing
2024-12-03 23:14:40,254 INFO server.py 235:: [Server] Test set: Average loss: 2.5228, Accuracy: 2246/10000 (22.46%)

2024-12-03 23:14:40,256 INFO server.py 238:: [Sever] Confusion matrix:
 tensor([[555.,   0., 249.,  13.,  92.,  16.,   8.,   0.,  67.,   0.],
        [132.,   0., 342.,  68., 264.,  85.,  57.,   0.,  52.,   0.],
        [119.,   0., 567.,  18., 192.,  71.,  31.,   0.,   2.,   0.],
        [ 31.,   0., 367.,  64., 281., 206.,  49.,   0.,   2.,   0.],
        [102.,   0., 426.,  10., 402.,  31.,  21.,   0.,   8.,   0.],
        [ 21.,   0., 277.,  51., 223., 391.,  37.,   0.,   0.,   0.],
        [ 56.,   0., 562.,  19., 240.,  37.,  85.,   0.,   1.,   0.],
        [ 25.,   0., 246.,  50., 503., 141.,  20.,   7.,   8.,   0.],
        [498.,   0., 189.,  11.,  94.,  17.,  16.,   0., 175.,   0.],
        [106.,   0., 290.,  69., 299., 133.,  46.,   0.,  57.,   0.]])
2024-12-03 23:14:40,257 INFO server.py 254:: [Server] Precision=[0.337386          nan 0.16130868 0.17158177 0.15521236 0.3466312
 0.22972973 1.         0.4704301         nan],
 Recall=[0.555 0.    0.567 0.064 0.402 0.391 0.085 0.007 0.175 0.   ],
 F1-score=[0.41965973        nan 0.25116277 0.09322651 0.22395544 0.3674812
 0.12408759 0.01390268 0.25510204        nan],
 my_accuracy=22.460000216960907[%]
2024-12-03 23:14:40,258 INFO _main.py 209:: ########EPOCH 2 ########
2024-12-03 23:14:40,258 INFO _main.py 210:: ###Model distribution###
2024-12-03 23:15:49,370 INFO server.py 1080:: clients' sizes=[15, 12, 5, 7, 6, 13, 13, 4, 4, 10, 13, 8, 5, 9, 12, 14, 6, 12, 11, 9, 6, 12, 17, 7, 9, 9, 8, 12, 9, 8, 6, 5, 9, 12, 9, 4, 7, 12, 14, 9], total=372
2024-12-03 23:15:52,308 INFO server.py 327:: [Server] The aggregation takes 5.112310 seconds.

2024-12-03 23:15:52,378 INFO server.py 211:: [Server] Start testing
2024-12-03 23:15:57,839 INFO server.py 235:: [Server] Test set: Average loss: 2.3718, Accuracy: 2700/10000 (27.0%)

2024-12-03 23:15:57,841 INFO server.py 238:: [Sever] Confusion matrix:
 tensor([[405.,   0., 263.,  13.,  87.,  26.,   9.,   0., 197.,   0.],
        [ 70.,   1., 256., 121., 173., 200.,  59.,   1., 119.,   0.],
        [ 74.,   0., 535.,  23., 232., 110.,  21.,   0.,   5.,   0.],
        [ 18.,   0., 281.,  98., 282., 280.,  34.,   0.,   7.,   0.],
        [ 37.,   0., 304.,  16., 557.,  54.,  13.,   0.,  19.,   0.],
        [ 11.,   0., 181.,  46., 190., 542.,  26.,   1.,   3.,   0.],
        [ 22.,   0., 448.,  38., 329.,  68.,  92.,   0.,   3.,   0.],
        [ 17.,   0., 168.,  72., 493., 227.,   6.,   8.,   9.,   0.],
        [235.,   0., 151.,  21.,  86.,  31.,  18.,   0., 458.,   0.],
        [ 37.,   0., 191.,  76., 203., 321.,  33.,   0., 135.,   4.]])
2024-12-03 23:15:57,843 INFO server.py 254:: [Server] Precision=[0.43736503 1.         0.19258459 0.1870229  0.21162614 0.2915546
 0.29581994 0.8        0.47958115 1.        ],
 Recall=[0.405 0.001 0.535 0.098 0.557 0.542 0.092 0.008 0.458 0.004],
 F1-score=[0.42056075 0.001998   0.28321865 0.12860893 0.30671808 0.37915355
 0.14035088 0.01584158 0.4685422  0.00796813],
 my_accuracy=27.000001072883606[%]
2024-12-03 23:15:57,843 INFO _main.py 209:: ########EPOCH 3 ########
2024-12-03 23:15:57,843 INFO _main.py 210:: ###Model distribution###
2024-12-03 23:18:03,834 INFO server.py 570:: flip_sign_id={0, 2, 10, 11, 18, 20}
2024-12-03 23:18:03,834 INFO server.py 585:: ===========using shortHoGs for detecting UNTARGETED ATTACK====
