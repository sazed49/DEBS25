2024-12-03 19:05:34,415 INFO _main.py 39:: ################################################################
2024-12-03 19:05:34,418 INFO _main.py 41:: #                              batch_size: 64                  #
2024-12-03 19:05:34,419 INFO _main.py 41:: #                         test_batch_size: 64                  #
2024-12-03 19:05:34,420 INFO _main.py 41:: #                                  epochs: 10                  #
2024-12-03 19:05:34,420 INFO _main.py 41:: #                               optimizer: SGD                 #
2024-12-03 19:05:34,420 INFO _main.py 41:: #                                      lr: 0.01                #
2024-12-03 19:05:34,420 INFO _main.py 41:: #                                momentum: 0.9                 #
2024-12-03 19:05:34,421 INFO _main.py 41:: #                            weight_decay: 0.0001              #
2024-12-03 19:05:34,421 INFO _main.py 41:: #                                    seed: 1                   #
2024-12-03 19:05:34,421 INFO _main.py 41:: #                            log_interval: 11                  #
2024-12-03 19:05:34,421 INFO _main.py 41:: #                             num_clients: 40                  #
2024-12-03 19:05:34,421 INFO _main.py 41:: #                           output_folder: experiments         #
2024-12-03 19:05:34,421 INFO _main.py 41:: #                                 dataset: cifar               #
2024-12-03 19:05:34,421 INFO _main.py 41:: #                             loader_type: dirichlet           #
2024-12-03 19:05:34,421 INFO _main.py 41:: #                             loader_path: ./data/loader.pk    #
2024-12-03 19:05:34,421 INFO _main.py 41:: #                                      AR: mudhog              #
2024-12-03 19:05:34,421 INFO _main.py 41:: #                     n_attacker_backdoor: 0                   #
2024-12-03 19:05:34,421 INFO _main.py 41:: #                        backdoor_trigger: [0, 0, 1, 1]        #
2024-12-03 19:05:34,421 INFO _main.py 41:: #                   n_attacker_omniscient: 0                   #
2024-12-03 19:05:34,421 INFO _main.py 41:: #                        omniscient_scale: 1                   #
2024-12-03 19:05:34,421 INFO _main.py 41:: #                                 attacks: None                #
2024-12-03 19:05:34,422 INFO _main.py 41:: #                      save_model_weights: False               #
2024-12-03 19:05:34,422 INFO _main.py 41:: #                         experiment_name: sExp4Ba_40ep_cifar_mudhog_40C_5#
2024-12-03 19:05:34,422 INFO _main.py 41:: #                          path_to_aggNet: None                #
2024-12-03 19:05:34,422 INFO _main.py 41:: #                                  device: cuda                #
2024-12-03 19:05:34,422 INFO _main.py 41:: #                            inner_epochs: 4                   #
2024-12-03 19:05:34,422 INFO _main.py 41:: #                                 verbose: True                #
2024-12-03 19:05:34,422 INFO _main.py 41:: #                         list_unreliable: [2, 18, 20]         #
2024-12-03 19:05:34,422 INFO _main.py 41:: #                     unreliable_fraction: 0.5                 #
2024-12-03 19:05:34,422 INFO _main.py 41:: #                    unreliable_fracTrain: 0.3                 #
2024-12-03 19:05:34,422 INFO _main.py 41:: #                         mean_unreliable: 0.0                 #
2024-12-03 19:05:34,422 INFO _main.py 41:: #                             blur_method: add_noise           #
2024-12-03 19:05:34,422 INFO _main.py 41:: #                      max_std_unreliable: 30.0                #
2024-12-03 19:05:34,422 INFO _main.py 41:: #                     list_uatk_add_noise: [24, 25, 26]        #
2024-12-03 19:05:34,423 INFO _main.py 41:: #                          mean_add_noise: 0.0                 #
2024-12-03 19:05:34,423 INFO _main.py 41:: #                           std_add_noise: 0.01                #
2024-12-03 19:05:34,423 INFO _main.py 41:: #                     list_uatk_flip_sign: [0, 10, 11]         #
2024-12-03 19:05:34,423 INFO _main.py 42:: ################################################################
2024-12-03 19:05:34,423 INFO _main.py 43:: Namespace(batch_size=64, test_batch_size=64, epochs=10, optimizer='SGD', lr=0.01, momentum=0.9, weight_decay=0.0001, seed=1, log_interval=11, num_clients=40, output_folder='experiments', dataset='cifar', loader_type='dirichlet', loader_path='./data/loader.pk', AR='mudhog', n_attacker_backdoor=0, backdoor_trigger=[0, 0, 1, 1], n_attacker_omniscient=0, omniscient_scale=1, attacks=None, save_model_weights=False, experiment_name='sExp4Ba_40ep_cifar_mudhog_40C_5', path_to_aggNet=None, device='cuda', inner_epochs=4, verbose=True, list_unreliable=[2, 18, 20], unreliable_fraction=0.5, unreliable_fracTrain=0.3, mean_unreliable=0.0, blur_method='add_noise', max_std_unreliable=30.0, list_uatk_add_noise=[24, 25, 26], mean_add_noise=0.0, std_add_noise=0.01, list_uatk_flip_sign=[0, 10, 11])
2024-12-03 19:05:34,423 INFO _main.py 44:: #####################
2024-12-03 19:05:34,423 INFO _main.py 45:: #####################
2024-12-03 19:05:34,423 INFO _main.py 46:: #####################
2024-12-03 19:05:34,423 INFO _main.py 47:: Aggregation Rule:	mudhog
2024-12-03 19:05:34,423 INFO _main.py 48:: Data distribution:	dirichlet
2024-12-03 19:05:34,423 INFO _main.py 49:: Attacks:	None 
2024-12-03 19:05:34,423 INFO _main.py 50:: #####################
2024-12-03 19:05:34,424 INFO _main.py 51:: #####################
2024-12-03 19:05:34,424 INFO _main.py 52:: #####################
2024-12-03 19:05:38,715 INFO server.py 366:: SET DBSCAN eps=18, min_samples=12
2024-12-03 19:05:38,745 INFO _main.py 135:: [1-normal, 0-malicious] label =tensor([0., 1., 1., 1., 1., 1., 1., 1., 1., 1., 0., 0., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 0., 0., 0., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1.])
2024-12-03 19:05:39,016 INFO malicious_clients.py 123:: init ATTACK OMNISCIENT Client 0
2024-12-03 19:05:39,479 INFO malicious_clients.py 18:: init UNRELIABLE Client 2
2024-12-03 19:05:41,628 INFO malicious_clients.py 123:: init ATTACK OMNISCIENT Client 10
2024-12-03 19:05:41,891 INFO malicious_clients.py 123:: init ATTACK OMNISCIENT Client 11
2024-12-03 19:05:43,738 INFO malicious_clients.py 18:: init UNRELIABLE Client 18
2024-12-03 19:05:44,313 INFO malicious_clients.py 18:: init UNRELIABLE Client 20
2024-12-03 19:05:45,436 INFO malicious_clients.py 73:: init ATTACK ADD NOISE TO GRAD Client 24
2024-12-03 19:05:45,698 INFO malicious_clients.py 73:: init ATTACK ADD NOISE TO GRAD Client 25
2024-12-03 19:05:45,959 INFO malicious_clients.py 73:: init ATTACK ADD NOISE TO GRAD Client 26
2024-12-03 19:05:49,546 INFO server.py 211:: [Server] Start testing
2024-12-03 19:05:55,017 INFO server.py 235:: [Server] Test set: Average loss: 2.3744, Accuracy: 908/10000 (9.08%)

2024-12-03 19:05:55,019 INFO server.py 238:: [Sever] Confusion matrix:
 tensor([[229., 420.,   6.,  74.,   8.,   0.,  33.,   1., 166.,  63.],
        [191., 240.,  33., 128.,  24.,   0.,  66.,   0., 125., 193.],
        [271., 348.,  31.,  41.,  11.,   0.,  29.,  10., 148., 111.],
        [173., 335.,  51.,  75.,  22.,   0.,  39.,   3.,  74., 228.],
        [210., 288.,  11.,  43.,   4.,   0.,  28.,  18., 284., 114.],
        [262., 227., 124.,  57.,  29.,   0.,  32.,   4.,  78., 187.],
        [134., 322.,  21.,  28.,   1.,   0.,  48.,   6., 289., 151.],
        [222., 251.,  50., 116.,  27.,   0.,  23.,  10., 157., 144.],
        [315., 366.,   4., 102.,   9.,   0.,  24.,   1., 106.,  73.],
        [269., 286.,  11.,  92.,  17.,   0.,  28.,   0., 132., 165.]])
2024-12-03 19:05:55,024 INFO server.py 254:: [Server] Precision=[0.10061511 0.07784625 0.09064327 0.09920635 0.02631579        nan
 0.13714285 0.18867925 0.0679923  0.11546536],
 Recall=[0.229 0.24  0.031 0.075 0.004 0.    0.048 0.01  0.106 0.165],
 F1-score=[0.13980463 0.11756062 0.0461997  0.08542142 0.00694444        nan
 0.07111111 0.01899335 0.08284485 0.13585837],
 my_accuracy=9.080000221729279[%]
2024-12-03 19:05:55,025 INFO _main.py 209:: ########EPOCH 0 ########
2024-12-03 19:05:55,025 INFO _main.py 210:: ###Model distribution###
2024-12-03 19:07:00,391 INFO server.py 1080:: clients' sizes=[15, 12, 5, 7, 6, 13, 13, 4, 4, 10, 13, 8, 5, 9, 12, 14, 6, 12, 11, 9, 6, 12, 17, 7, 9, 9, 8, 12, 9, 8, 6, 5, 9, 12, 9, 4, 7, 12, 14, 9], total=372
2024-12-03 19:07:04,015 INFO server.py 327:: [Server] The aggregation takes 5.947277 seconds.

2024-12-03 19:07:04,065 INFO server.py 211:: [Server] Start testing
2024-12-03 19:07:08,103 INFO server.py 235:: [Server] Test set: Average loss: 2.1108, Accuracy: 2467/10000 (24.67%)

2024-12-03 19:07:08,105 INFO server.py 238:: [Sever] Confusion matrix:
 tensor([[513.,   0.,  30.,  23., 163., 101.,  87.,   0.,  83.,   0.],
        [ 67.,   3.,   8.,  40., 274., 409., 135.,   2.,  57.,   5.],
        [132.,   0.,  75.,  37., 361., 272., 120.,   1.,   2.,   0.],
        [ 20.,   0.,  15.,  26., 266., 533., 133.,   3.,   4.,   0.],
        [ 74.,   0.,  13.,  26., 618., 134., 125.,   1.,   9.,   0.],
        [ 13.,   0.,  10.,  17., 187., 683.,  88.,   0.,   2.,   0.],
        [ 48.,   0.,  31.,  25., 401., 194., 300.,   0.,   1.,   0.],
        [ 22.,   0.,   6.,  25., 497., 369.,  67.,   9.,   5.,   0.],
        [391.,   0.,  15.,  29., 122., 118.,  92.,   0., 232.,   1.],
        [ 58.,   3.,   9.,  34., 256., 464.,  89.,   1.,  78.,   8.]])
2024-12-03 19:07:08,106 INFO server.py 254:: [Server] Precision=[0.38340807 0.5        0.3537736  0.09219858 0.19650239 0.20842233
 0.24271844 0.5294118  0.49048626 0.5714286 ],
 Recall=[0.513 0.003 0.075 0.026 0.618 0.683 0.3   0.009 0.232 0.008],
 F1-score=[0.4388366  0.00596421 0.12376238 0.04056162 0.2981906  0.31938273
 0.26833633 0.01769911 0.3150034  0.01577909],
 my_accuracy=24.67000037431717[%]
2024-12-03 19:07:08,106 INFO _main.py 209:: ########EPOCH 1 ########
2024-12-03 19:07:08,107 INFO _main.py 210:: ###Model distribution###
2024-12-03 19:08:13,209 INFO server.py 1080:: clients' sizes=[15, 12, 5, 7, 6, 13, 13, 4, 4, 10, 13, 8, 5, 9, 12, 14, 6, 12, 11, 9, 6, 12, 17, 7, 9, 9, 8, 12, 9, 8, 6, 5, 9, 12, 9, 4, 7, 12, 14, 9], total=372
2024-12-03 19:08:16,862 INFO server.py 327:: [Server] The aggregation takes 6.004845 seconds.

2024-12-03 19:08:16,913 INFO server.py 211:: [Server] Start testing
2024-12-03 19:08:20,999 INFO server.py 235:: [Server] Test set: Average loss: 2.5093, Accuracy: 2250/10000 (22.5%)

2024-12-03 19:08:21,000 INFO server.py 238:: [Sever] Confusion matrix:
 tensor([[465.,   0., 224.,   9.,  83.,  10.,   9.,   0., 200.,   0.],
        [130.,   0., 302.,  83., 248.,  77.,  67.,   0.,  93.,   0.],
        [136.,   0., 591.,  21., 165.,  53.,  28.,   0.,   6.,   0.],
        [ 43.,   0., 412.,  79., 281., 127.,  50.,   0.,   8.,   0.],
        [110.,   0., 489.,  12., 328.,  20.,  22.,   0.,  19.,   0.],
        [ 35.,   0., 315.,  67., 224., 323.,  34.,   0.,   2.,   0.],
        [ 91.,   0., 619.,  24., 158.,  24.,  80.,   0.,   4.,   0.],
        [ 35.,   0., 271.,  66., 514.,  94.,   8.,   5.,   7.,   0.],
        [352.,   0., 162.,   9.,  71.,  13.,  14.,   0., 379.,   0.],
        [106.,   0., 271.,  66., 301., 117.,  40.,   0.,  99.,   0.]])
2024-12-03 19:08:21,002 INFO server.py 254:: [Server] Precision=[0.30938125        nan 0.16165207 0.18119267 0.13822167 0.3764569
 0.22727273 1.         0.46389228        nan],
 Recall=[0.465 0.    0.591 0.079 0.328 0.323 0.08  0.005 0.379 0.   ],
 F1-score=[0.3715541         nan 0.253866   0.11002786 0.19448562 0.34768566
 0.11834319 0.00995025 0.41717118        nan],
 my_accuracy=22.499999403953552[%]
2024-12-03 19:08:21,002 INFO _main.py 209:: ########EPOCH 2 ########
2024-12-03 19:08:21,002 INFO _main.py 210:: ###Model distribution###
2024-12-03 19:09:26,504 INFO server.py 1080:: clients' sizes=[15, 12, 5, 7, 6, 13, 13, 4, 4, 10, 13, 8, 5, 9, 12, 14, 6, 12, 11, 9, 6, 12, 17, 7, 9, 9, 8, 12, 9, 8, 6, 5, 9, 12, 9, 4, 7, 12, 14, 9], total=372
2024-12-03 19:09:29,926 INFO server.py 327:: [Server] The aggregation takes 5.743112 seconds.

2024-12-03 19:09:29,981 INFO server.py 211:: [Server] Start testing
2024-12-03 19:09:34,050 INFO server.py 235:: [Server] Test set: Average loss: 2.3614, Accuracy: 2713/10000 (27.13%)

2024-12-03 19:09:34,052 INFO server.py 238:: [Sever] Confusion matrix:
 tensor([[414.,   0., 220.,   8.,  80.,  22.,   2.,   0., 254.,   0.],
        [ 63.,   0., 270.,  97., 161., 167.,  50.,   1., 190.,   1.],
        [111.,   0., 529.,  19., 204.,  95.,  29.,   0.,  13.,   0.],
        [ 31.,   0., 313.,  83., 284., 245.,  34.,   0.,  10.,   0.],
        [ 61.,   0., 334.,  11., 512.,  42.,  16.,   0.,  24.,   0.],
        [ 20.,   0., 190.,  44., 187., 519.,  34.,   0.,   6.,   0.],
        [ 62.,   0., 498.,  28., 255.,  61.,  92.,   0.,   4.,   0.],
        [ 16.,   0., 197.,  58., 505., 198.,   5.,   8.,  13.,   0.],
        [191.,   0., 122.,  13.,  77.,  28.,  16.,   0., 553.,   0.],
        [ 36.,   0., 186.,  62., 208., 283.,  30.,   0., 192.,   3.]])
2024-12-03 19:09:34,054 INFO server.py 254:: [Server] Precision=[0.4119403         nan 0.18502973 0.19621749 0.20703599 0.3126506
 0.2987013  0.8888889  0.43923748 0.75      ],
 Recall=[0.414 0.    0.529 0.083 0.512 0.519 0.092 0.008 0.553 0.003],
 F1-score=[0.41296756        nan 0.27416426 0.11665495 0.29484597 0.39022556
 0.14067277 0.01585728 0.48959714 0.0059761 ],
 my_accuracy=27.129998803138733[%]
2024-12-03 19:09:34,054 INFO _main.py 209:: ########EPOCH 3 ########
2024-12-03 19:09:34,054 INFO _main.py 210:: ###Model distribution###
2024-12-03 19:11:33,314 INFO server.py 570:: flip_sign_id={0, 2, 10, 11, 18, 20}
2024-12-03 19:11:33,315 INFO server.py 585:: ===========using shortHoGs for detecting UNTARGETED ATTACK====
